{"componentChunkName":"component---gatsby-theme-maskzh-src-templates-blog-post-tsx","path":"/小程序一套代码多实例部署/","result":{"data":{"site":{"siteMetadata":{"title":"ZYC's Blog"}},"markdownRemark":{"html":"<p>现在有两个方案</p>\n<ol>\n<li>使用小程序第三方平台</li>\n<li>不使用小程序第三方平台</li>\n</ol>\n<h3>使用小程序第三方平台</h3>\n<ol>\n<li>申请一个普通的小程序，然后在第三方平台上将该小程序添加<em>开发小程序</em>。</li>\n<li>绑定为开发小程序后，该小程序的代码会直接上传到开放平台，不会上传到公众平台。</li>\n<li>开发小程序的代码会显示在草稿箱中，可以选定一个版本作为模版，添加为模版后，则可以得到模版 ID。</li>\n<li>然后就是可以调用微信的接口为已授权给第三方平台的小程序部署代码了。部署代码时，可以传递<code>ext_json</code>，作为第三方自定义的配置，然后在小程序中，可以通过<code>wx.getExtConfigSync</code>来获取<code>ext_json</code>中的信息。通过这个机制，可以实现不同实例的不同配置。<a href=\"https://developers.weixin.qq.com/miniprogram/dev/devtools/ext.html#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%9D%BF%E5%BC%80%E5%8F%91\">ext_json 相关文档</a></li>\n</ol>\n<p><strong>重点提示</strong>：\n小程序授权托管之后，只能使用第三方平台的在微信开放平台登记的服务器地址。\n所以第三方平台在帮助旗下公众号发布代码之前，需先把服务器地址设置到小程序的服务器地址中，设置接口详见“修改服务器地址”文档中的接口。</p>\n<p>总结：使用第三方平台可以只使用一份代码，可以通过微信的接口来配置和部署小程序。适合独立主体申请的小程序授权给第三方平台，分发数量比较高的场景。</p>\n<h3>不使用小程序第三方平台</h3>\n<p>也能实现只用一份代码。</p>\n<ol>\n<li>申请小程序</li>\n<li>添加开发人员（小程序预览）</li>\n<li>设置开发设置（服务器域名、业务域名等）</li>\n<li>获取上传代码的 token</li>\n<li>为小程序部署代码</li>\n</ol>\n<p>其中 2、3、4 都需要登录小程序管理后台，因此对于独立主体申请的小程序，不可避免需要索取权限，而第三方平台在授权后则不需要。</p>\n<p>总结：这个方案更灵活简单一些。可以不通过开放平台（第三方平台）来实现。但不太适合大批量的部署。优点是能适应多客户，多域名，更灵活的定制的需求。</p>","rawMarkdownBody":"\n现在有两个方案\n\n1. 使用小程序第三方平台\n2. 不使用小程序第三方平台\n\n### 使用小程序第三方平台\n\n1. 申请一个普通的小程序，然后在第三方平台上将该小程序添加*开发小程序*。\n2. 绑定为开发小程序后，该小程序的代码会直接上传到开放平台，不会上传到公众平台。\n3. 开发小程序的代码会显示在草稿箱中，可以选定一个版本作为模版，添加为模版后，则可以得到模版 ID。\n4. 然后就是可以调用微信的接口为已授权给第三方平台的小程序部署代码了。部署代码时，可以传递`ext_json`，作为第三方自定义的配置，然后在小程序中，可以通过`wx.getExtConfigSync`来获取`ext_json`中的信息。通过这个机制，可以实现不同实例的不同配置。[ext_json 相关文档](https://developers.weixin.qq.com/miniprogram/dev/devtools/ext.html#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%9D%BF%E5%BC%80%E5%8F%91)\n\n**重点提示**：\n小程序授权托管之后，只能使用第三方平台的在微信开放平台登记的服务器地址。\n所以第三方平台在帮助旗下公众号发布代码之前，需先把服务器地址设置到小程序的服务器地址中，设置接口详见“修改服务器地址”文档中的接口。\n\n总结：使用第三方平台可以只使用一份代码，可以通过微信的接口来配置和部署小程序。适合独立主体申请的小程序授权给第三方平台，分发数量比较高的场景。\n\n### 不使用小程序第三方平台\n\n也能实现只用一份代码。\n\n1. 申请小程序\n2. 添加开发人员（小程序预览）\n3. 设置开发设置（服务器域名、业务域名等）\n4. 获取上传代码的 token\n5. 为小程序部署代码\n\n其中 2、3、4 都需要登录小程序管理后台，因此对于独立主体申请的小程序，不可避免需要索取权限，而第三方平台在授权后则不需要。\n\n总结：这个方案更灵活简单一些。可以不通过开放平台（第三方平台）来实现。但不太适合大批量的部署。优点是能适应多客户，多域名，更灵活的定制的需求。\n","timeToRead":2,"wordCount":{"paragraphs":19,"sentences":19,"words":67},"frontmatter":{"title":"小程序一套代码多实例部署","tags":["Tech/Wechat"],"created":"2020-05-29"}}},"pageContext":{"slug":"/小程序一套代码多实例部署/","language":"en","i18n":{"language":"en","languages":["en","zh"],"defaultLanguage":"en","routed":false,"resources":{"en":{"translation":{"home":"Home","not found":"Not found","create date":"CREATE DATE","search articles":"Search","articles":"Articles"}}},"originalPath":"/小程序一套代码多实例部署/","path":"/小程序一套代码多实例部署/"}}},"staticQueryHashes":["1985809839","1985809839","63159454"]}