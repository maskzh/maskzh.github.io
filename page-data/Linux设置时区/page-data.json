{"componentChunkName":"component---gatsby-theme-maskzh-src-templates-blog-post-tsx","path":"/Linux设置时区/","result":{"data":{"site":{"siteMetadata":{"title":"ZYC's Blog"}},"markdownRemark":{"html":"<p>CentOS 和 Ubuntu 的时区是 <code>/etc/localtime</code>。可以通过<code>ll /etc/localtime</code>来查看。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">lrwxrwxrwx 1 root root 33 May 18 14:40 /etc/localtime -> /usr/share/zoneinfo/Asia/Shanghai</code></pre></div>\n<p>之前都是通过</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></pre></div>\n<p>来修改系统时区。</p>\n<p>但 CentOS 7 之后，<code>/etc/localtime</code> 文件变成了一个链接，所以直接使用<code>cp</code>可能会导致错误。</p>\n<p>现在修改系统时区最好的方法就是使用<code>timedatectl</code>。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">timedatectl list-timezones <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Shanghai <span class=\"token comment\"># 查找完整名称</span>\ntimedatectl set-timezone Asia/Shanghai <span class=\"token comment\"># 设置时区</span></code></pre></div>\n<p>主机上可以通过上述方法来修改，容器该如果修改呢？</p>\n<p>Debian 系的系统内置了<code>tzdata</code>。在 <code>Dockerfile</code> 中声明<code>TZ</code>环境变量即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token instruction\"><span class=\"token keyword\">ENV</span> TZ=Asia/Shanghai</span></code></pre></div>\n<p>Alpine 系的系统没有内置<code>tzdata</code>，所以还需要安装<code>tzdata</code>。</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token instruction\"><span class=\"token keyword\">ENV</span> TZ=Asia/Shanghai</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apk update \\<span class=\"token operator\">\\</span></span>\n    &amp;&amp; apk add tzdata \\\\\n    &amp;&amp; echo \"${TZ}\" > /etc/timezone \\\\\n    &amp;&amp; ln -sf /usr/share/zoneinfo/${TZ} /etc/localtime \\\\\n    &amp;&amp; rm /var/cache/apk/*</code></pre></div>","rawMarkdownBody":"\nCentOS 和 Ubuntu 的时区是 `/etc/localtime`。可以通过`ll /etc/localtime`来查看。\n\n```\nlrwxrwxrwx 1 root root 33 May 18 14:40 /etc/localtime -> /usr/share/zoneinfo/Asia/Shanghai\n```\n\n之前都是通过\n\n```bash\ncp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n```\n\n来修改系统时区。\n\n但 CentOS 7 之后，`/etc/localtime` 文件变成了一个链接，所以直接使用`cp`可能会导致错误。\n\n现在修改系统时区最好的方法就是使用`timedatectl`。\n\n```bash\ntimedatectl list-timezones | grep Shanghai # 查找完整名称\ntimedatectl set-timezone Asia/Shanghai # 设置时区\n```\n\n主机上可以通过上述方法来修改，容器该如果修改呢？\n\nDebian 系的系统内置了`tzdata`。在 `Dockerfile` 中声明`TZ`环境变量即可。\n\n```docker\nENV TZ=Asia/Shanghai\n```\n\nAlpine 系的系统没有内置`tzdata`，所以还需要安装`tzdata`。\n\n```docker\nENV TZ=Asia/Shanghai\n\nRUN apk update \\\\\n    && apk add tzdata \\\\\n    && echo \"${TZ}\" > /etc/timezone \\\\\n    && ln -sf /usr/share/zoneinfo/${TZ} /etc/localtime \\\\\n    && rm /var/cache/apk/*\n```\n","timeToRead":1,"wordCount":{"paragraphs":8,"sentences":8,"words":26},"frontmatter":{"title":"Linux 设置时区（含构建镜像时设置时区）","tags":["Tech/Linux"],"created":"2020-07-25"}}},"pageContext":{"slug":"/Linux设置时区/","language":"en","i18n":{"language":"en","languages":["en","zh"],"defaultLanguage":"en","routed":false,"resources":{"en":{"translation":{"home":"Home","not found":"Not found","create date":"CREATE DATE","search articles":"Search","articles":"Articles"}}},"originalPath":"/Linux设置时区/","path":"/Linux设置时区/"}}},"staticQueryHashes":["1985809839","1985809839","63159454"]}